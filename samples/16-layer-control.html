<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>16 - ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .description {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        #map {
            height: 550px;
            width: 100%;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .code-section {
            margin-top: 20px;
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .code-section pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>16 - ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</h1>
        <div class="description">
            <p><strong>å­¦ç¿’å†…å®¹:</strong> Leafletæ¨™æº–ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«UIã‚’ä½¿ç”¨ã—ã¦ãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒ—ã¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚</p>
            <p><strong>ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
            <ul>
                <li>L.control.layers() ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’ä½œæˆ</li>
                <li>ç¬¬1å¼•æ•°: ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã€æ’ä»–çš„ï¼‰</li>
                <li>ç¬¬2å¼•æ•°: ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã€è¤‡æ•°é¸æŠå¯ï¼‰</li>
                <li>åœ°å›³å³ä¸Šã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’åˆ‡ã‚Šæ›¿ãˆ</li>
            </ul>
        </div>

        <div id="map"></div>

        <div class="code-section">
            <pre>
// ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å®šç¾©
const baseLayers = {
    "OpenStreetMap": osmLayer,
    "CartoDB Light": cartoLight,
    "CartoDB Dark": cartoDark
};

// ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å®šç¾©
const overlays = {
    "ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³": restaurantsGroup,
    "ãƒ›ãƒ†ãƒ«": hotelsGroup,
    "é§…": stationsGroup
};

// ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¿½åŠ 
L.control.layers(baseLayers, overlays, {
    collapsed: false,  // å¸¸ã«å±•é–‹è¡¨ç¤º
    position: 'topright'
}).addTo(map);
            </pre>
        </div>
    </div>

    <!-- Leaflet.jsæœ¬ä½“ã‚’èª­ã¿è¾¼ã‚€ -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // ========================================
        // ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ã‚µãƒ³ãƒ—ãƒ«
        // Leafletæ¨™æº–ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ‡ã‚Šæ›¿ãˆUIã‚’ä½¿ç”¨
        // ========================================

        // ----------------------------------------
        // ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆã‚¿ã‚¤ãƒ«ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰ã‚’å®šç¾©
        // ----------------------------------------
        // ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã§æ’ä»–çš„ã«é¸æŠ
        // ä¸€åº¦ã«1ã¤ã—ã‹è¡¨ç¤ºã§ããªã„
        const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        });

        const cartoLight = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
        });

        const cartoDark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
        });

        const esriSatellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles &copy; Esri'
        });

        // ----------------------------------------
        // åœ°å›³ã‚’åˆæœŸåŒ–
        // ----------------------------------------
        // layers ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§åˆæœŸè¡¨ç¤ºã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æŒ‡å®š
        const map = L.map('map', {
            center: [35.6812, 139.7671],
            zoom: 13,
            layers: [osmLayer]  // åˆæœŸè¡¨ç¤ºã™ã‚‹ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼
        });

        // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¤ã‚³ãƒ³ã®ä½œæˆé–¢æ•°
        function createIcon(emoji) {
            return L.divIcon({
                className: '',
                html: `<div style="font-size: 24px;">${emoji}</div>`,
                iconSize: [30, 30],
                iconAnchor: [15, 15],
                popupAnchor: [0, -10]
            });
        }

        // ----------------------------------------
        // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œæˆ
        // ----------------------------------------
        // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¯ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§è¤‡æ•°é¸æŠå¯èƒ½
        // ãƒãƒ¼ã‚«ãƒ¼ã€ãƒãƒªã‚´ãƒ³ã€ãƒãƒªãƒ©ã‚¤ãƒ³ãªã©ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
        const restaurantsGroup = L.layerGroup();
        const hotelsGroup = L.layerGroup();
        const stationsGroup = L.layerGroup();
        const parksGroup = L.layerGroup();

        // ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãƒ‡ãƒ¼ã‚¿
        [
            { name: 'ã‚¤ã‚¿ãƒªã‚¢ãƒ³ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³', lat: 35.6830, lng: 139.7700 },
            { name: 'å’Œé£Ÿãƒ¬ã‚¹ãƒˆãƒ©ãƒ³', lat: 35.6780, lng: 139.7650 },
            { name: 'ãƒ•ãƒ¬ãƒ³ãƒãƒ¬ã‚¹ãƒˆãƒ©ãƒ³', lat: 35.6850, lng: 139.7600 }
        ].forEach(r => {
            L.marker([r.lat, r.lng], { icon: createIcon('ğŸœ') })
                .bindPopup(`<b>${r.name}</b>`)
                .addTo(restaurantsGroup);
        });

        // ãƒ›ãƒ†ãƒ«ãƒ‡ãƒ¼ã‚¿
        [
            { name: 'ã‚°ãƒ©ãƒ³ãƒ‰ãƒ›ãƒ†ãƒ«', lat: 35.6870, lng: 139.7680 },
            { name: 'ãƒ“ã‚¸ãƒã‚¹ãƒ›ãƒ†ãƒ«', lat: 35.6800, lng: 139.7580 }
        ].forEach(h => {
            L.marker([h.lat, h.lng], { icon: createIcon('ğŸ¨') })
                .bindPopup(`<b>${h.name}</b>`)
                .addTo(hotelsGroup);
        });

        // é§…ãƒ‡ãƒ¼ã‚¿
        [
            { name: 'æ±äº¬é§…', lat: 35.6812, lng: 139.7671 },
            { name: 'æœ‰æ¥½ç”ºé§…', lat: 35.6750, lng: 139.7630 },
            { name: 'ç¥ç”°é§…', lat: 35.6917, lng: 139.7703 }
        ].forEach(s => {
            L.marker([s.lat, s.lng], { icon: createIcon('ğŸš‰') })
                .bindPopup(`<b>${s.name}</b>`)
                .addTo(stationsGroup);
        });

        // å…¬åœ’ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒãƒªã‚´ãƒ³ï¼‰
        L.polygon([
            [35.6880, 139.7520],
            [35.6880, 139.7580],
            [35.6830, 139.7580],
            [35.6830, 139.7520]
        ], {
            color: 'green',
            fillColor: '#90EE90',
            fillOpacity: 0.5
        }).bindPopup('å…¬åœ’ã‚¨ãƒªã‚¢').addTo(parksGroup);

        L.polygon([
            [35.6750, 139.7700],
            [35.6750, 139.7750],
            [35.6720, 139.7750],
            [35.6720, 139.7700]
        ], {
            color: 'green',
            fillColor: '#90EE90',
            fillOpacity: 0.5
        }).bindPopup('å…¬åœ’ã‚¨ãƒªã‚¢2').addTo(parksGroup);

        // ----------------------------------------
        // ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ç”¨ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
        // ----------------------------------------
        // ã‚­ãƒ¼ãŒã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹åå‰
        // å€¤ãŒãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        const baseLayers = {
            "OpenStreetMap": osmLayer,
            "CartoDB Light": cartoLight,
            "CartoDB Dark": cartoDark,
            "è¡›æ˜Ÿå†™çœŸ": esriSatellite
        };

        // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆçµµæ–‡å­—ã‚‚ä½¿ãˆã‚‹ï¼‰
        const overlays = {
            "ğŸœ ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³": restaurantsGroup,
            "ğŸ¨ ãƒ›ãƒ†ãƒ«": hotelsGroup,
            "ğŸš‰ é§…": stationsGroup,
            "ğŸŒ³ å…¬åœ’": parksGroup
        };

        // åˆæœŸè¡¨ç¤ºã™ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’åœ°å›³ã«è¿½åŠ 
        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã«ç™»éŒ²ã™ã‚‹ã ã‘ã§ã¯è¡¨ç¤ºã•ã‚Œãªã„
        restaurantsGroup.addTo(map);
        stationsGroup.addTo(map);

        // ----------------------------------------
        // L.control.layers() ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¿½åŠ 
        // ----------------------------------------
        // ç¬¬1å¼•æ•°: ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ï¼‰
        // ç¬¬2å¼•æ•°: ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼‰
        // ç¬¬3å¼•æ•°: ã‚ªãƒ—ã‚·ãƒ§ãƒ³
        L.control.layers(baseLayers, overlays, {
            collapsed: true,   // true: ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼ã§å±•é–‹, false: å¸¸ã«å±•é–‹
            position: 'topright'  // é…ç½®ä½ç½®
        }).addTo(map);

        // ----------------------------------------
        // ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ‡ã‚Šæ›¿ãˆã‚¤ãƒ™ãƒ³ãƒˆã®ç›£è¦–
        // ----------------------------------------
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’åˆ‡ã‚Šæ›¿ãˆãŸã¨ãã«å‡¦ç†ã‚’å®Ÿè¡Œã§ãã‚‹
        map.on('baselayerchange', function(e) {
            console.log('ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼å¤‰æ›´:', e.name);
        });

        map.on('overlayadd', function(e) {
            console.log('ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¿½åŠ :', e.name);
        });

        map.on('overlayremove', function(e) {
            console.log('ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å‰Šé™¤:', e.name);
        });
    </script>
</body>
</html>
