<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>17 - ã‚¹ã‚±ãƒ¼ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨ãã®ä»–ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .description {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        #map {
            height: 550px;
            width: 100%;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .code-section {
            margin-top: 20px;
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .code-section pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        /* ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .custom-control {
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 1px 5px rgba(0,0,0,0.2);
        }
        .coord-control {
            font-family: monospace;
            font-size: 12px;
        }
        .home-button {
            width: 30px;
            height: 30px;
            background: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 18px;
            box-shadow: 0 1px 5px rgba(0,0,0,0.2);
        }
        .home-button:hover {
            background: #f4f4f4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>17 - ã‚¹ã‚±ãƒ¼ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨ãã®ä»–ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</h1>
        <div class="description">
            <p><strong>å­¦ç¿’å†…å®¹:</strong> åœ°å›³ã«ã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆç¸®å°ºï¼‰ã‚„ãã®ä»–ã®æ¨™æº–ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
            <p><strong>ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
            <ul>
                <li>L.control.scale() ã§ç¸®å°ºãƒãƒ¼ã‚’è¿½åŠ </li>
                <li>L.control.zoom() ã§ã‚ºãƒ¼ãƒ ãƒœã‚¿ãƒ³ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¡¨ç¤ºï¼‰</li>
                <li>L.control.attribution() ã§è‘—ä½œæ¨©è¡¨ç¤º</li>
                <li>position ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§é…ç½®ã‚’å¤‰æ›´ï¼ˆtopright, topleft, bottomright, bottomleftï¼‰</li>
            </ul>
        </div>

        <div id="map"></div>

        <div class="code-section">
            <pre>
// ã‚¹ã‚±ãƒ¼ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¿½åŠ 
L.control.scale({
    maxWidth: 200,
    metric: true,      // ãƒ¡ãƒ¼ãƒˆãƒ«æ³•
    imperial: true,    // ãƒã‚¤ãƒ«æ³•
    position: 'bottomleft'
}).addTo(map);

// ã‚ºãƒ¼ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ä½ç½®ã‚’å¤‰æ›´
map.zoomControl.setPosition('topright');

// ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’ä½œæˆ
const customControl = L.Control.extend({
    options: { position: 'bottomright' },
    onAdd: function(map) {
        const container = L.DomUtil.create('div', 'custom-control');
        container.innerHTML = 'ã‚«ã‚¹ã‚¿ãƒ æƒ…å ±';
        return container;
    }
});
new customControl().addTo(map);
            </pre>
        </div>
    </div>

    <!-- Leaflet.jsæœ¬ä½“ã‚’èª­ã¿è¾¼ã‚€ -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // ========================================
        // ã‚¹ã‚±ãƒ¼ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ã‚µãƒ³ãƒ—ãƒ«
        // ========================================

        // ----------------------------------------
        // åœ°å›³ã‚’åˆæœŸåŒ–
        // ----------------------------------------
        // zoomControl: false ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚ºãƒ¼ãƒ ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
        // å¾Œã§åˆ¥ã®ä½ç½®ã«è¿½åŠ ã™ã‚‹
        const map = L.map('map', {
            center: [35.6812, 139.7671],
            zoom: 13,
            zoomControl: false  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚ºãƒ¼ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ–
        });

        // ã‚¿ã‚¤ãƒ«ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¿½åŠ 
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // ----------------------------------------
        // ã‚ºãƒ¼ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’å³ä¸Šã«è¿½åŠ 
        // ----------------------------------------
        // position: é…ç½®ä½ç½®ï¼ˆtopright, topleft, bottomright, bottomleftï¼‰
        L.control.zoom({
            position: 'topright'
        }).addTo(map);

        // ----------------------------------------
        // ã‚¹ã‚±ãƒ¼ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼ˆç¸®å°ºãƒãƒ¼ï¼‰ã‚’è¿½åŠ 
        // ----------------------------------------
        // åœ°å›³ã®ç¸®å°ºã‚’è¦–è¦šçš„ã«è¡¨ç¤º
        L.control.scale({
            maxWidth: 200,     // æœ€å¤§å¹…ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰
            metric: true,      // ãƒ¡ãƒ¼ãƒˆãƒ«æ³•ã‚’è¡¨ç¤º
            imperial: true,    // ãƒã‚¤ãƒ«æ³•ã‚’è¡¨ç¤º
            position: 'bottomleft'
        }).addTo(map);

        // ----------------------------------------
        // ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ä½œæˆ
        // ----------------------------------------
        // L.Control.extend() ã§æ—¢å­˜ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’æ‹¡å¼µ

        // åº§æ¨™è¡¨ç¤ºã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
        const CoordControl = L.Control.extend({
            options: {
                position: 'bottomright'
            },
            // onAdd: ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãŒåœ°å›³ã«è¿½åŠ ã•ã‚ŒãŸã¨ãã«å‘¼ã°ã‚Œã‚‹
            // DOMè¦ç´ ã‚’ä½œæˆã—ã¦è¿”ã™
            onAdd: function(map) {
                // L.DomUtil.create() ã§DOMè¦ç´ ã‚’ä½œæˆ
                // ç¬¬1å¼•æ•°: ã‚¿ã‚°å, ç¬¬2å¼•æ•°: CSSã‚¯ãƒ©ã‚¹å
                const container = L.DomUtil.create('div', 'custom-control coord-control');
                container.id = 'coord-display';
                container.innerHTML = 'ç·¯åº¦: --, çµŒåº¦: --';

                // é‡è¦: ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ä¸Šã®ã‚¯ãƒªãƒƒã‚¯ãŒåœ°å›³ã«ä¼æ’­ã—ãªã„ã‚ˆã†ã«ã™ã‚‹
                L.DomEvent.disableClickPropagation(container);

                return container;
            }
        });
        // new ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ã¦ addTo() ã§åœ°å›³ã«è¿½åŠ 
        new CoordControl().addTo(map);

        // ãƒã‚¦ã‚¹ç§»å‹•ã§åº§æ¨™ã‚’æ›´æ–°
        map.on('mousemove', function(e) {
            document.getElementById('coord-display').innerHTML =
                `ç·¯åº¦: ${e.latlng.lat.toFixed(6)}, çµŒåº¦: ${e.latlng.lng.toFixed(6)}`;
        });

        // ----------------------------------------
        // ãƒ›ãƒ¼ãƒ ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
        // ----------------------------------------
        // ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨åˆæœŸä½ç½®ã«æˆ»ã‚‹
        const HomeControl = L.Control.extend({
            options: {
                position: 'topleft'
            },
            onAdd: function(map) {
                const container = L.DomUtil.create('div', '');
                const button = L.DomUtil.create('button', 'home-button', container);
                button.innerHTML = 'ğŸ ';
                button.title = 'åˆæœŸä½ç½®ã«æˆ»ã‚‹';

                // L.DomEvent.on() ã§ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ç™»éŒ²
                L.DomEvent.on(button, 'click', function(e) {
                    // stopPropagation() ã§ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢
                    L.DomEvent.stopPropagation(e);
                    // åˆæœŸä½ç½®ã«æˆ»ã‚‹
                    map.setView([35.6812, 139.7671], 13);
                });

                L.DomEvent.disableClickPropagation(container);

                return container;
            }
        });
        new HomeControl().addTo(map);

        // ----------------------------------------
        // æƒ…å ±ãƒ‘ãƒãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
        // ----------------------------------------

        // æƒ…å ±ãƒ‘ãƒãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
        const InfoControl = L.Control.extend({
            options: {
                position: 'topright'
            },
            onAdd: function(map) {
                const container = L.DomUtil.create('div', 'custom-control');
                container.innerHTML = `
                    <strong>åœ°å›³æƒ…å ±</strong><br>
                    <span id="zoom-level">ã‚ºãƒ¼ãƒ : ${map.getZoom()}</span><br>
                    <span id="center-pos">ä¸­å¿ƒ: èª­ã¿è¾¼ã¿ä¸­...</span>
                `;
                container.style.maxWidth = '200px';
                container.style.fontSize = '12px';

                L.DomEvent.disableClickPropagation(container);

                return container;
            }
        });
        new InfoControl().addTo(map);

        // ã‚ºãƒ¼ãƒ ãƒ»ç§»å‹•æ™‚ã«æƒ…å ±ã‚’æ›´æ–°
        function updateInfo() {
            const center = map.getCenter();
            document.getElementById('zoom-level').textContent = `ã‚ºãƒ¼ãƒ : ${map.getZoom()}`;
            document.getElementById('center-pos').textContent =
                `ä¸­å¿ƒ: ${center.lat.toFixed(4)}, ${center.lng.toFixed(4)}`;
        }

        map.on('zoomend moveend', updateInfo);
        updateInfo();

        // ãƒãƒ¼ã‚«ãƒ¼è¿½åŠ 
        L.marker([35.6812, 139.7671])
            .addTo(map)
            .bindPopup('æ±äº¬é§…');
    </script>
</body>
</html>
